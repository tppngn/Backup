firewall {
    broadcast-ping disable
    conntrack-table-size 50000000
    ip-src-route enable
    receive-redirects enable
    send-redirects enable
}
interfaces {
    ethernet eth0 {
        duplex full
        hw-id 00:15:17:94:ef:f1
        speed 1000
    }
    ethernet eth1 {
        address 172.1.2.1/24
        hw-id 00:15:17:94:ef:f0
    }
    ethernet eth2 {
        duplex auto
        hw-id 00:15:17:94:ef:f3
        vif 160 {
        }
    }
    ethernet eth3 {
        duplex auto
        hw-id 00:15:17:94:ef:f2
    }
    ethernet eth4 {
        address 10.100.128.1/19
        address 190.14.191.193/29
        address 10.15.128.1/19
        address 10.30.128.1/24
        description LAN
        duplex full
        hw-id 00:1a:64:21:99:42
        speed 1000
        vif 15 {
            address 10.15.15.1/16
            address 10.200.128.1/24
        }
        vif 20 {
            address 10.20.128.1/19
            address 190.14.173.1/24
        }
        vif 30 {
            address 10.31.128.1/19
            address 190.14.163.1/24
            address 190.14.168.1/23
            address 190.14.188.1/23
            address 190.14.186.1/23
            address 190.14.184.1/23
            address 190.114.146.1/24
            address 190.14.190.1/24
            address 190.14.191.1/25
            address 190.14.160.1/24
            address 190.114.144.1/24
            address 190.114.148.1/24
            address 190.14.161.1/24
            address 190.14.162.1/24
            address 190.114.168.1/24
            address 190.114.169.1/24
            address 190.114.170.1/24
        }
        vif 160 {
            address 10.15.160.1/24
            address 10.15.161.1/28
        }
    }
    ethernet eth5 {
        description WAN
        duplex full
        hw-id 00:1a:64:21:99:43
        speed 1000
        vif 428 {
            address 200.51.216.238/30
        }
    }
    loopback lo {
    }
}
protocols {
    snmp {
        community tppsa {
            authorization ro
        }
    }
    static {
        route 0.0.0.0/0 {
            next-hop 200.51.216.237 {
            }
        }
        route 10.22.128.0/24 {
            next-hop 10.15.128.18 {
            }
        }
        route 10.40.0.0/16 {
            next-hop 10.15.128.24 {
            }
        }
        route 10.50.128.0/24 {
            next-hop 10.15.128.6 {
            }
        }
        route 10.100.128.0/24 {
            next-hop 190.14.173.234 {
            }
        }
        route 10.115.40.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 10.140.141.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 10.141.141.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 10.215.110.0/24 {
            next-hop 10.30.128.110 {
            }
        }
        route 10.215.111.0/24 {
            next-hop 10.30.128.111 {
            }
        }
        route 10.215.112.0/24 {
            next-hop 10.30.128.112 {
            }
        }
        route 10.215.113.0/24 {
            next-hop 10.30.128.113 {
            }
        }
        route 10.215.120.0/24 {
            next-hop 10.30.128.120 {
            }
        }
        route 10.215.121.0/24 {
            next-hop 10.30.128.121 {
            }
        }
        route 10.215.122.0/24 {
            next-hop 10.30.128.122 {
            }
        }
        route 10.215.123.0/24 {
            next-hop 10.30.128.123 {
            }
        }
        route 10.215.124.0/24 {
            next-hop 10.30.128.124 {
            }
        }
        route 10.215.129.0/24 {
            next-hop 10.15.128.129 {
            }
        }
        route 10.215.130.0/24 {
            next-hop 10.15.128.130 {
            }
        }
        route 10.215.131.0/24 {
            next-hop 10.15.128.131 {
            }
        }
        route 10.215.132.0/24 {
            next-hop 10.15.128.132 {
            }
        }
        route 10.215.133.0/24 {
            next-hop 10.15.128.133 {
            }
        }
        route 10.215.134.0/24 {
            next-hop 10.15.128.134 {
            }
        }
        route 10.215.138.0/24 {
            next-hop 10.15.128.138 {
            }
        }
        route 10.215.139.0/24 {
            next-hop 10.15.128.139 {
            }
        }
        route 10.215.140.0/24 {
            next-hop 10.15.128.140 {
            }
        }
        route 10.215.141.0/24 {
            next-hop 10.15.128.141 {
            }
        }
        route 10.215.151.0/24 {
            next-hop 10.15.128.151 {
            }
        }
        route 10.215.152.0/24 {
            next-hop 10.15.128.152 {
            }
        }
        route 10.215.153.0/24 {
            next-hop 10.15.128.153 {
            }
        }
        route 10.215.171.0/24 {
            next-hop 10.15.128.171 {
            }
        }
        route 10.215.172.0/24 {
            next-hop 10.15.128.172 {
            }
        }
        route 10.215.173.0/24 {
            next-hop 10.15.128.173 {
            }
        }
        route 10.215.174.0/24 {
            next-hop 10.15.128.174 {
            }
        }
        route 10.215.175.0/24 {
            next-hop 10.15.128.175 {
            }
        }
        route 10.215.176.0/24 {
            next-hop 10.15.128.176 {
            }
        }
        route 10.215.177.0/24 {
            next-hop 10.15.128.177 {
            }
        }
        route 10.215.191.0/24 {
            next-hop 10.15.128.191 {
            }
        }
        route 10.215.192.0/24 {
            next-hop 10.15.128.192 {
            }
        }
        route 10.215.193.0/24 {
            next-hop 10.15.128.193 {
            }
        }
        route 10.215.199.0/24 {
            next-hop 10.15.128.199 {
            }
        }
        route 10.215.202.0/24 {
            next-hop 10.15.128.202 {
            }
        }
        route 10.215.203.0/24 {
            next-hop 10.15.128.203 {
            }
        }
        route 10.215.204.0/24 {
            next-hop 10.15.128.204 {
            }
        }
        route 10.215.205.0/24 {
            next-hop 10.15.128.205 {
            }
        }
        route 10.215.206.0/24 {
            next-hop 10.15.128.206 {
            }
        }
        route 10.215.209.0/24 {
            next-hop 10.15.128.209 {
            }
        }
        route 10.215.210.0/24 {
            next-hop 10.15.128.210 {
            }
        }
        route 10.215.211.0/24 {
            next-hop 10.15.128.211 {
            }
        }
        route 10.215.212.0/24 {
            next-hop 10.15.128.212 {
            }
        }
        route 10.215.218.0/24 {
            next-hop 10.15.128.218 {
            }
        }
        route 10.215.219.0/24 {
            next-hop 10.15.128.219 {
            }
        }
        route 10.215.220.0/24 {
            next-hop 10.15.128.220 {
            }
        }
        route 10.215.241.0/24 {
            next-hop 10.15.128.241 {
            }
        }
        route 10.215.242.0/24 {
            next-hop 10.15.128.242 {
            }
        }
        route 10.215.243.0/24 {
            next-hop 10.15.128.243 {
            }
        }
        route 10.215.245.0/24 {
            next-hop 10.15.128.245 {
            }
        }
        route 10.230.93.0/24 {
            next-hop 10.30.128.93 {
            }
        }
        route 10.230.94.0/24 {
            next-hop 10.30.128.94 {
            }
        }
        route 10.230.95.0/24 {
            next-hop 10.30.128.95 {
            }
        }
        route 10.230.96.0/24 {
            next-hop 10.30.128.96 {
            }
        }
        route 10.230.97.0/24 {
            next-hop 10.30.128.97 {
            }
        }
        route 10.230.98.0/24 {
            next-hop 10.30.128.98 {
            }
        }
        route 10.230.124.0/24 {
            next-hop 10.30.128.124 {
            }
        }
        route 10.230.126.0/24 {
            next-hop 10.30.128.126 {
            }
        }
        route 10.230.128.0/24 {
            next-hop 10.30.128.128 {
            }
        }
        route 10.230.129.0/24 {
            next-hop 10.30.128.129 {
            }
        }
        route 10.230.130.0/24 {
            next-hop 10.30.128.130 {
            }
        }
        route 10.230.131.0/24 {
            next-hop 10.30.128.131 {
            }
        }
        route 10.230.132.0/24 {
            next-hop 10.30.128.132 {
            }
        }
        route 10.230.133.0/24 {
            next-hop 10.30.128.133 {
            }
        }
        route 10.230.134.0/24 {
            next-hop 10.30.128.134 {
            }
        }
        route 10.230.135.0/24 {
            next-hop 10.30.128.135 {
            }
        }
        route 10.230.150.0/24 {
            next-hop 10.30.128.150 {
            }
        }
        route 10.230.151.0/24 {
            next-hop 10.30.128.151 {
            }
        }
        route 10.230.161.0/24 {
            next-hop 10.30.128.161 {
            }
        }
        route 10.230.165.0/24 {
            next-hop 10.30.128.165 {
            }
        }
        route 10.230.166.0/24 {
            next-hop 10.30.128.166 {
            }
        }
        route 10.230.167.0/24 {
            next-hop 10.30.128.167 {
            }
        }
        route 10.230.168.0/24 {
            next-hop 10.30.128.168 {
            }
        }
        route 10.240.0.0/16 {
            next-hop 10.15.128.24 {
            }
        }
        route 172.16.0.0/22 {
            next-hop 10.15.128.24 {
            }
        }
        route 172.40.111.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.14.164.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.14.165.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.14.166.0/23 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.14.172.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.145.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.147.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.149.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.150.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.151.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.152.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.153.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.154.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.155.0/25 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.155.128/26 {
            next-hop 10.40.130.50 {
            }
        }
        route 190.114.155.192/26 {
            next-hop 10.40.130.50 {
            }
        }
        route 190.114.156.0/22 {
            next-hop 10.15.128.18 {
            }
        }
        route 190.114.171.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.172.0/24 {
            next-hop 10.15.128.24 {
            }
        }
        route 190.114.173.0/24 {
            next-hop 10.15.128.24 {
            }
        }
    }
}
service {
    https
    nat {
        rule 12 {
            description MuxApparTV
            destination {
                address 190.14.163.253
            }
            inbound-interface eth5.428
            inside-address {
                address 10.15.160.2
            }
            type destination
        }
        rule 13 {
            description MuxStreamTel
            destination {
                address 190.14.163.254
            }
            inbound-interface eth5.428
            inside-address {
                address 10.15.160.5
            }
            type destination
        }
        rule 19 {
            description EPGServer
            destination {
                address 190.14.163.251
            }
            inbound-interface eth5.428
            inside-address {
                address 10.15.160.6
            }
            type destination
        }
        rule 20 {
            description NatOutsideCanlDelVientoNet
            destination {
                address !10.10.128.0/17
            }
            outbound-interface eth5.428
            outside-address {
                address 190.14.163.250
            }
            source {
                address 10.15.160.0/24
            }
            type source
        }
        rule 40 {
            description NatPrizm
            destination {
                address 190.14.163.252
            }
            inbound-interface eth5.428
            inside-address {
                address 10.15.128.4
            }
            type destination
        }
    }
    ssh {
        allow-root true
        port 3522
    }
    telnet {
        allow-root false
    }
}
system {
    host-name RouterCR-Oficina
    login {
        user root {
            authentication {
                encrypted-password ****************
                plaintext-password ****************
            }
        }
        user vyatta {
            authentication {
                encrypted-password ****************
                plaintext-password ****************
            }
        }
    }
    ntp-server 10.15.128.128
    package {
        auto-sync 1
        repository community {
            components main
            distribution stable
            url http://packages.vyatta.com/vyatta
        }
        repository debian {
            components "main contrib"
            distribution squeeze
            url http://ftp.us.debian.org/debian
        }
    }
}
vpn {
    ipsec {
        copy-tos disable
        esp-group ESP-1CDR {
            compression disable
            lifetime 1800
            proposal 1 {
                encryption aes256
            }
            proposal 2 {
                encryption 3des
                hash md5
            }
        }
        ike-group IKE-1CDR {
            aggressive-mode disable
            lifetime 3600
            proposal 1 {
                encryption aes256
            }
            proposal 2 {
                encryption aes128
            }
        }
        ipsec-interfaces {
            interface eth4
            interface eth4.15
            interface eth4.30
        }
        site-to-site {
            peer 190.2.46.194 {
                authentication {
                    mode pre-shared-secret
                    pre-shared-secret ****************
                }
                ike-group IKE-1CDR
                local-ip 190.14.190.1
                tunnel 1 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.15.128.0/19
                    remote-subnet 10.10.128.0/17
                }
                tunnel 2 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.15.128.0/19
                    remote-subnet 192.168.0.0/16
                }
                tunnel 3 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.30.128.0/24
                    remote-subnet 10.10.128.0/17
                }
                tunnel 4 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.15.160.0/24
                    remote-subnet 10.10.128.0/17
                }
                tunnel 5 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.15.160.0/24
                    remote-subnet 192.168.0.0/16
                }
                tunnel 6 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.30.128.0/24
                    remote-subnet 192.168.0.0/16
                }
                tunnel 7 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.215.0.0/16
                    remote-subnet 10.10.128.0/17
                }
                tunnel 8 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.215.0.0/16
                    remote-subnet 192.168.0.0/16
                }
                tunnel 9 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.115.40.0/24
                    remote-subnet 10.10.128.0/17
                }
                tunnel 10 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.230.0.0/16
                    remote-subnet 10.10.128.0/17
                }
                tunnel 11 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.40.0.0/16
                    remote-subnet 10.10.128.0/17
                }
                tunnel 12 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.40.0.0/16
                    remote-subnet 192.168.0.0/16
                }
                tunnel 14 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.140.141.0/24
                    remote-subnet 10.10.128.0/17
                }
                tunnel 15 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.140.141.0/24
                    remote-subnet 192.168.0.0/16
                }
                tunnel 16 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.141.141.0/24
                    remote-subnet 10.10.128.0/17
                }
                tunnel 17 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.240.0.0/16
                    remote-subnet 10.10.128.0/17
                }
                tunnel 18 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.240.0.0/16
                    remote-subnet 192.168.0.0/16
                }
                tunnel 19 {
                    allow-nat-networks disable
                    esp-group ESP-1CDR
                    local-subnet 10.141.141.0/24
                    remote-subnet 192.168.0.0/16
                }
            }
        }
    }
}
